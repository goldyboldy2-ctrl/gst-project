<!DOCTYPE html>

<html lang="en">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VVBKGDPYBE"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-VVBKGDPYBE');
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="canonical" href="https://mygstindia.in/preferences.html">
  <title>My Preferences - MyGSTIndia</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@700&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --navy: #1e293b; --blue: #3b82f6; --blue-dark: #2563eb;
      --orange: #f59e0b; --orange-dark: #d97706; --green: #10b981;
      --gray-50: #f8fafc; --gray-100: #f1f5f9; --gray-200: #e2e8f0;
      --gray-600: #475569; --gray-700: #334155; --gray-900: #0f172a;
    }
    
    body { font-family: 'Inter', sans-serif; color: var(--gray-900); line-height: 1.7; background: var(--gray-50); }
    h1, h2, h3 { font-family: 'Poppins', sans-serif; line-height: 1.3; color: var(--navy); }
    
    /* Navbar */
    .navbar { background: white; border-bottom: 1px solid var(--gray-200); padding: 1rem 0; position: sticky; top: 0; z-index: 100; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    .nav-container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; display: flex; align-items: center; justify-content: space-between; }
    .logo { display: flex; align-items: center; gap: 0.75rem; text-decoration: none; color: var(--navy); font-weight: 700; font-size: 1.25rem; }
    .logo-mark { width: 48px; height: 48px; background: linear-gradient(135deg, var(--orange), var(--orange-dark)); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; font-weight: 800; }
    .logo-text { color: var(--blue); }
    
    /* User Menu */
    .user-menu { position: relative; }
    .user-btn { display: flex; align-items: center; gap: 0.5rem; background: none; border: none; cursor: pointer; padding: 0.5rem 1rem; border-radius: 8px; transition: background 0.2s; }
    .user-btn:hover { background: var(--gray-100); }
    .user-photo { width: 32px; height: 32px; border-radius: 50%; }
    .user-name { font-weight: 600; color: var(--gray-700); }
    .dropdown { position: absolute; top: 100%; right: 0; margin-top: 0.5rem; background: white; border: 1px solid var(--gray-200); border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); min-width: 200px; display: none; }
    .dropdown.active { display: block; }
    .dropdown a { display: block; padding: 0.75rem 1rem; color: var(--gray-700); text-decoration: none; transition: background 0.2s; }
    .dropdown a:hover { background: var(--gray-50); }
    .dropdown hr { margin: 0.5rem 0; border: none; border-top: 1px solid var(--gray-200); }
    
    /* Login Button (Guest) */
    .login-btn { background: white; border: 2px solid var(--blue); color: var(--blue); padding: 0.5rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-block; }
    .login-btn:hover { background: var(--blue); color: white; }
    
    /* Main Content */
    .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
    .page-header { margin-bottom: 2rem; }
    .page-header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    .page-header p { color: var(--gray-600); }
    
    /* Privacy Notice */
    .privacy-notice { background: #eff6ff; border-left: 4px solid var(--blue); padding: 1.5rem; margin-bottom: 2rem; border-radius: 8px; }
    .privacy-notice h3 { color: var(--blue); margin-bottom: 0.5rem; font-size: 1.1rem; }
    .privacy-notice ul { margin-left: 1.5rem; margin-top: 0.5rem; }
    
    /* Card */
    .card { background: white; border-radius: 12px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .card h2 { font-size: 1.5rem; margin-bottom: 1.5rem; }
    
    /* Form Group */
    .form-group { margin-bottom: 1.5rem; }
    .form-group label { display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--gray-700); }
    .form-group select, .form-group input { width: 100%; padding: 0.75rem; border: 2px solid var(--gray-200); border-radius: 8px; font-size: 1rem; transition: border-color 0.2s; }
    .form-group select:focus, .form-group input:focus { outline: none; border-color: var(--blue); }
    .form-help { font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem; }
    
    /* Radio Group */
    .radio-group { display: flex; gap: 1rem; }
    .radio-option { display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1rem; border: 2px solid var(--gray-200); border-radius: 8px; cursor: pointer; transition: all 0.2s; }
    .radio-option:hover { border-color: var(--blue); }
    .radio-option.active { border-color: var(--blue); background: #eff6ff; }
    .radio-option input { margin: 0; }
    
    /* Tool Grid */
    .tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem; }
    .tool-card { padding: 1rem; border: 2px solid var(--gray-200); border-radius: 8px; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 0.75rem; }
    .tool-card:hover { border-color: var(--blue); }
    .tool-card.favorited { border-color: var(--orange); background: #fef3c7; }
    .tool-icon { font-size: 1.5rem; }
    .tool-name { font-weight: 600; }
    .star-icon { margin-left: auto; font-size: 1.25rem; }
    .tool-card.favorited .star-icon { color: var(--orange); }
    
    /* Stats Grid */
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 1.5rem; }
    .stat-card { background: linear-gradient(135deg, var(--blue), var(--blue-dark)); color: white; padding: 1.5rem; border-radius: 12px; text-align: center; }
    .stat-value { font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem; }
    .stat-label { opacity: 0.9; }
    
    /* Buttons */
    .btn { padding: 0.75rem 2rem; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; font-size: 1rem; }
    .btn-primary { background: var(--blue); color: white; }
    .btn-primary:hover { background: var(--blue-dark); transform: translateY(-2px); }
    .btn-secondary { background: var(--gray-200); color: var(--gray-700); }
    .btn-secondary:hover { background: var(--gray-300); }
    
    /* Success Message */
    .success-message { background: #d1fae5; border-left: 4px solid var(--green); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; display: none; }
    .success-message.show { display: block; }
  </style>

</head>
<body>

<!-- Navbar -->

<nav class="navbar">
  <div class="nav-container">
    <a href="index.html" class="logo">
      <div class="logo-mark">M</div>
      <span class="logo-text">MyGSTIndia</span>
    </a>

```
<!-- User Menu (Logged In) -->
<div class="user-menu" id="userMenu" style="display: none;">
  <button class="user-btn" onclick="toggleDropdown()">
    <img src="https://via.placeholder.com/32" alt="User" class="user-photo" id="userPhoto">
    <span class="user-name" id="userName">User</span>
    <span>‚ñæ</span>
  </button>
  <div class="dropdown" id="userDropdown">
    <a href="preferences.html">‚öôÔ∏è Preferences</a>
    <a href="dashboard.html">üìä Dashboard</a>
    <a href="favorites.html">‚≠ê Favorites</a>
    <hr>
    <a href="#" onclick="signOut()">üö™ Sign Out</a>
  </div>
</div>

<!-- Login Button (Guest) -->
<button class="login-btn" id="loginBtn" onclick="signIn()">
  üéÅ Sign In
</button>
```

  </div>
</nav>

<!-- Main Content -->

<div class="container">
  <!-- Page Header -->
  <div class="page-header">
    <h1>‚öôÔ∏è My Preferences</h1>
    <p>Customize your GST toolkit experience</p>
  </div>

  <!-- Privacy Notice -->

  <div class="privacy-notice">
    <h3>üîí Your Privacy is Protected</h3>
    <p><strong>We NEVER store:</strong></p>
    <ul>
      <li>Your GSTIN numbers</li>
      <li>Invoice details or amounts</li>
      <li>Calculation results</li>
      <li>Any financial data</li>
    </ul>
    <p style="margin-top: 0.5rem;"><strong>We only save:</strong> Your tool preferences and favorites (optional)</p>
  </div>

  <!-- Success Message -->

  <div class="success-message" id="successMessage">
    ‚úÖ Preferences saved successfully!
  </div>

  <!-- Calculation Preferences -->

  <div class="card">
    <h2>Calculation Preferences</h2>

```
<div class="form-group">
  <label for="defaultRate">Default GST Rate</label>
  <select id="defaultRate">
    <option value="">-- Select rate --</option>
    <option value="5">5% GST</option>
    <option value="12">12% GST</option>
    <option value="18" selected>18% GST</option>
    <option value="28">28% GST</option>
  </select>
  <div class="form-help">This rate will be pre-selected in calculators</div>
</div>

<div class="form-group">
  <label for="defaultState">Default State</label>
  <select id="defaultState">
    <option value="">-- Select state --</option>
    <option value="AN">Andaman and Nicobar Islands</option>
    <option value="AP">Andhra Pradesh</option>
    <option value="AR">Arunachal Pradesh</option>
    <option value="AS">Assam</option>
    <option value="BR">Bihar</option>
    <option value="CH">Chandigarh</option>
    <option value="CT">Chhattisgarh</option>
    <option value="DN">Dadra and Nagar Haveli and Daman and Diu</option>
    <option value="DL">Delhi</option>
    <option value="GA">Goa</option>
    <option value="GJ">Gujarat</option>
    <option value="HR">Haryana</option>
    <option value="HP">Himachal Pradesh</option>
    <option value="JK">Jammu and Kashmir</option>
    <option value="JH">Jharkhand</option>
    <option value="KA">Karnataka</option>
    <option value="KL">Kerala</option>
    <option value="LA">Ladakh</option>
    <option value="LD">Lakshadweep</option>
    <option value="MP">Madhya Pradesh</option>
    <option value="MH">Maharashtra</option>
    <option value="MN">Manipur</option>
    <option value="ML">Meghalaya</option>
    <option value="MZ">Mizoram</option>
    <option value="NL">Nagaland</option>
    <option value="OR">Odisha</option>
    <option value="PY">Puducherry</option>
    <option value="PB">Punjab</option>
    <option value="RJ">Rajasthan</option>
    <option value="SK">Sikkim</option>
    <option value="TN">Tamil Nadu</option>
    <option value="TG">Telangana</option>
    <option value="TR">Tripura</option>
    <option value="UP">Uttar Pradesh</option>
    <option value="UT">Uttarakhand</option>
    <option value="WB">West Bengal</option>
  </select>
  <div class="form-help">For inter/intra-state calculations</div>
</div>
```

  </div>

  <!-- Display Preferences -->

  <div class="card">
    <h2>Display Preferences</h2>

```
<div class="form-group">
  <label>Theme</label>
  <div class="radio-group">
    <label class="radio-option active" onclick="selectTheme('light')">
      <input type="radio" name="theme" value="light" checked>
      <span>‚òÄÔ∏è Light</span>
    </label>
    <label class="radio-option" onclick="selectTheme('dark')">
      <input type="radio" name="theme" value="dark">
      <span>üåô Dark</span>
    </label>
  </div>
  <div class="form-help">Coming soon: Dark mode support</div>
</div>
```

  </div>

  <!-- Favorite Tools -->

  <div class="card">
    <h2>‚≠ê Favorite Tools</h2>
    <p style="color: var(--gray-600); margin-bottom: 1rem;">Click to mark tools as favorites for quick access</p>

```
<div class="tool-grid">
  <div class="tool-card" onclick="toggleFavorite('gst-calculator')" data-tool="gst-calculator">
    <span class="tool-icon">üßÆ</span>
    <span class="tool-name">GST Calculator</span>
    <span class="star-icon">‚òÜ</span>
  </div>
  
  <div class="tool-card" onclick="toggleFavorite('hsn-finder')" data-tool="hsn-finder">
    <span class="tool-icon">üîç</span>
    <span class="tool-name">HSN Finder</span>
    <span class="star-icon">‚òÜ</span>
  </div>
  
  <div class="tool-card" onclick="toggleFavorite('penalty-calculator')" data-tool="penalty-calculator">
    <span class="tool-icon">‚ö†Ô∏è</span>
    <span class="tool-name">Penalty Calculator</span>
    <span class="star-icon">‚òÜ</span>
  </div>
  
  <div class="tool-card" onclick="toggleFavorite('itc-calculator')" data-tool="itc-calculator">
    <span class="tool-icon">üí∞</span>
    <span class="tool-name">ITC Calculator</span>
    <span class="star-icon">‚òÜ</span>
  </div>
  
  <div class="tool-card" onclick="toggleFavorite('eway-bill-calculator')" data-tool="eway-bill-calculator">
    <span class="tool-icon">üöö</span>
    <span class="tool-name">E-Way Bill</span>
    <span class="star-icon">‚òÜ</span>
  </div>
  
  <div class="tool-card" onclick="toggleFavorite('invoice-generator')" data-tool="invoice-generator">
    <span class="tool-icon">üìÑ</span>
    <span class="tool-name">Invoice Generator</span>
    <span class="star-icon">‚òÜ</span>
  </div>
</div>
```

  </div>

  <!-- Save Button -->

  <div style="text-align: center; margin-top: 2rem;">
    <button class="btn btn-primary" onclick="savePreferences()">üíæ Save Preferences</button>
    <button class="btn btn-secondary" onclick="resetPreferences()" style="margin-left: 1rem;">üîÑ Reset to Default</button>
  </div>
</div>

<!-- Firebase SDK -->

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<!-- Auth Config -->

<script type="module" src="auth-config.js"></script>

<!-- Auth Service -->

<script type="module" src="auth-service.js"></script>

<script>
// Toggle dropdown
function toggleDropdown() {
  document.getElementById('userDropdown').classList.toggle('active');
}

// Close dropdown when clicking outside
document.addEventListener('click', function(e) {
  const userMenu = document.getElementById('userMenu');
  if (userMenu && !userMenu.contains(e.target)) {
    document.getElementById('userDropdown').classList.remove('active');
  }
});

// Select theme
function selectTheme(theme) {
  document.querySelectorAll('.radio-option').forEach(option => {
    option.classList.remove('active');
  });
  event.target.closest('.radio-option').classList.add('active');
}

// Toggle favorite
function toggleFavorite(toolId) {
  const card = event.target.closest('.tool-card');
  card.classList.toggle('favorited');
  
  const star = card.querySelector('.star-icon');
  star.textContent = card.classList.contains('favorited') ? '‚òÖ' : '‚òÜ';
  
  // Track with auth service
  if (typeof authService !== 'undefined' && authService.isLoggedIn()) {
    authService.toggleFavorite(toolId);
  }
}

// Save preferences
async function savePreferences() {
  const preferences = {
    defaultGSTRate: parseInt(document.getElementById('defaultRate').value) || 18,
    defaultState: document.getElementById('defaultState').value || '',
    theme: document.querySelector('input[name="theme"]:checked').value
  };
  
  // Save via auth service
  if (typeof authService !== 'undefined') {
    await authService.savePreferences(preferences);
  } else {
    // Fallback to localStorage
    localStorage.setItem('myGSTPreferences', JSON.stringify(preferences));
  }
  
  // Show success message
  const successMsg = document.getElementById('successMessage');
  successMsg.classList.add('show');
  setTimeout(() => {
    successMsg.classList.remove('show');
  }, 3000);
  
  // Track in GA
  gtag('event', 'save_preferences', {
    default_rate: preferences.defaultGSTRate,
    has_state: preferences.defaultState !== ''
  });
}

// Reset preferences
function resetPreferences() {
  if (confirm('Reset all preferences to default?')) {
    document.getElementById('defaultRate').value = '18';
    document.getElementById('defaultState').value = '';
    document.querySelectorAll('.tool-card').forEach(card => {
      card.classList.remove('favorited');
      card.querySelector('.star-icon').textContent = '‚òÜ';
    });
    document.querySelector('input[value="light"]').click();
  }
}

// Sign in
async function signIn() {
  if (typeof authService !== 'undefined') {
    await authService.signInWithGoogle();
  } else {
    alert('Authentication not configured. Please set up Firebase.');
  }
}

// Sign out
async function signOut() {
  if (typeof authService !== 'undefined') {
    await authService.signOut();
    window.location.href = 'index.html';
  }
}

// Load preferences on page load
window.addEventListener('load', async () => {
  // Wait for auth service
  setTimeout(async () => {
    if (typeof authService !== 'undefined') {
      const preferences = await authService.loadUserPreferences();
      
      if (preferences) {
        // Apply loaded preferences
        if (preferences.defaultGSTRate) {
          document.getElementById('defaultRate').value = preferences.defaultGSTRate;
        }
        if (preferences.defaultState) {
          document.getElementById('defaultState').value = preferences.defaultState;
        }
        if (preferences.theme) {
          document.querySelector(`input[value="${preferences.theme}"]`).click();
        }
      }
      
      // Load favorites
      const favorites = await authService.getFavorites();
      favorites.forEach(toolId => {
        const card = document.querySelector(`[data-tool="${toolId}"]`);
        if (card) {
          card.classList.add('favorited');
          card.querySelector('.star-icon').textContent = '‚òÖ';
        }
      });
    }
  }, 1000);
});
</script>

    <!-- Mobile Menu Toggle Script -->
    <script>
    (function() {
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileNav = document.getElementById('mobileNav');
        
        if (mobileMenuBtn && mobileNav) {
            mobileMenuBtn.addEventListener('click', function() {
                if (mobileNav.style.display === 'none' || mobileNav.style.display === '') {
                    mobileNav.style.display = 'block';
                    mobileMenuBtn.textContent = '‚úï';
                } else {
                    mobileNav.style.display = 'none';
                    mobileMenuBtn.textContent = '‚ò∞';
                }
            });
            
            // Close menu when clicking a link
            const mobileLinks = mobileNav.getElementsByTagName('a');
            for (let i = 0; i < mobileLinks.length; i++) {
                mobileLinks[i].addEventListener('click', function() {
                    mobileNav.style.display = 'none';
                    mobileMenuBtn.textContent = '‚ò∞';
                });
            }
        }
    })();
    </script>
</body>
</html>
